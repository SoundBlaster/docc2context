# H1.2 â€“ Cloudsmith Publish Script: Selective Channel Uploads

**Status:** Planning (SELECT_NEXT) â†’ In Progress (START)
**Date:** 2025-12-17
**Owner:** docc2context agent
**Depends On:** None (Cloudsmith helper + tests already exist)

---

## ðŸŽ¯ Intent

Make `Scripts/publish_to_cloudsmith.sh` support publishing **only Debian** or **only RPM** artifacts via explicit flags, so maintainers can enable apt or dnf distribution independently without the helper failing when the other artifact type is absent.

This is an unblocked H1 follow-up that improves operator ergonomics while H1 remains blocked on external hosting credentials.

---

## âœ… Selection Rationale

- The release workflow currently gathers multiple artifact sets; operators may want to stage Cloudsmith publishing incrementally (apt first, rpm later).
- The Cloudsmith helper currently treats missing `.deb` or missing `.rpm` as fatal; adding opt-in flags keeps the default strict while enabling selective uploads when desired.
- This work is testable offline via the existing `CloudsmithPublishScriptTests` harness and `--dry-run`.

---

## âœ… Acceptance Criteria

- [ ] `bash Scripts/publish_to_cloudsmith.sh --dry-run` continues to fail when both `.deb` and `.rpm` are missing (current behavior preserved).
- [ ] New flags allow selective publishing:
  - [ ] `--skip-rpm` allows `.deb`-only directories to succeed.
  - [ ] `--skip-deb` allows `.rpm`-only directories to succeed.
  - [ ] Passing both `--skip-rpm` and `--skip-deb` fails fast with a clear error (nothing to upload).
- [ ] Tests cover the new behavior and remain deterministic.
- [ ] Operator docs mention the flags in the Cloudsmith section (`.github/SECRETS.md`).

---

## ðŸ”œ Test Plan (START)

Add XCTest cases to `CloudsmithPublishScriptTests`:
- `.deb`-only + `--skip-rpm` succeeds and prints only deb upload commands.
- `.rpm`-only + `--skip-deb` succeeds and prints only rpm upload commands.
- `--skip-deb --skip-rpm` fails with a helpful message.

